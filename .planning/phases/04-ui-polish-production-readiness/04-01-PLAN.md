---
phase: 04-ui-polish-production-readiness
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/src/hooks/useBreakpoint.ts
  - frontend/src/lib/retry.ts
autonomous: true

must_haves:
  truths:
    - "useBreakpoint hook returns current breakpoint (mobile/tablet/desktop)"
    - "retry utility implements exponential backoff with jitter"
    - "Required npm packages are installed"
  artifacts:
    - path: "frontend/src/hooks/useBreakpoint.ts"
      provides: "Responsive breakpoint detection hook"
      exports: ["useBreakpoint"]
    - path: "frontend/src/lib/retry.ts"
      provides: "Exponential backoff utilities"
      exports: ["calculateBackoff", "retry"]
  key_links:
    - from: "frontend/src/hooks/useBreakpoint.ts"
      to: "window.matchMedia"
      via: "resize event listener"
      pattern: "matchMedia.*min-width"
---

<objective>
Install Phase 4 dependencies and create foundation hooks for responsive design and error handling.

Purpose: Establish shared utilities that other Phase 4 plans will use for mobile breakpoints and retry logic.
Output: Installed packages (sonner, react-loading-skeleton, react-swipeable, react-simple-pull-to-refresh, react-error-boundary) and two utility modules.
</objective>

<execution_context>
@C:\Users\maxi\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\maxi\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-ui-polish-production-readiness/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Phase 4 dependencies</name>
  <files>frontend/package.json</files>
  <action>
    Run npm install in frontend directory:
    ```bash
    cd frontend && npm install sonner react-loading-skeleton react-swipeable react-simple-pull-to-refresh react-error-boundary
    ```

    These packages provide:
    - sonner: Toast notifications (de-facto standard for shadcn/ui projects)
    - react-loading-skeleton: Skeleton loading states
    - react-swipeable: Touch gesture detection
    - react-simple-pull-to-refresh: Pull-to-refresh functionality
    - react-error-boundary: React error boundary helper
  </action>
  <verify>Check package.json contains all 5 new dependencies</verify>
  <done>All dependencies installed and listed in package.json</done>
</task>

<task type="auto">
  <name>Task 2: Create useBreakpoint hook</name>
  <files>frontend/src/hooks/useBreakpoint.ts</files>
  <action>
    Create responsive breakpoint detection hook at frontend/src/hooks/useBreakpoint.ts.

    Implementation requirements:
    - Export type Breakpoint = 'mobile' | 'tablet' | 'desktop'
    - mobile: < 768px (default, unprefixed in Tailwind)
    - tablet: >= 768px and < 1024px (md: in Tailwind)
    - desktop: >= 1024px (lg: in Tailwind)
    - Use window.matchMedia for detection
    - Listen to resize events with proper cleanup
    - Return current breakpoint string
    - Also export isMobile boolean helper for convenience

    Pattern from RESEARCH.md:
    ```typescript
    function useBreakpoint() {
      const [breakpoint, setBreakpoint] = useState<Breakpoint>('mobile')

      useEffect(() => {
        const updateBreakpoint = () => {
          if (window.matchMedia('(min-width: 1024px)').matches) {
            setBreakpoint('desktop')
          } else if (window.matchMedia('(min-width: 768px)').matches) {
            setBreakpoint('tablet')
          } else {
            setBreakpoint('mobile')
          }
        }

        updateBreakpoint()
        window.addEventListener('resize', updateBreakpoint)
        return () => window.removeEventListener('resize', updateBreakpoint)
      }, [])

      return { breakpoint, isMobile: breakpoint === 'mobile' }
    }
    ```
  </action>
  <verify>TypeScript compiles without errors: cd frontend && npx tsc --noEmit</verify>
  <done>useBreakpoint hook exports breakpoint type and isMobile helper</done>
</task>

<task type="auto">
  <name>Task 3: Create retry utilities</name>
  <files>frontend/src/lib/retry.ts</files>
  <action>
    Create exponential backoff utilities at frontend/src/lib/retry.ts.

    Export these functions:

    1. calculateBackoff(attemptNumber: number, baseDelay?: number, maxDelay?: number): number
       - Default baseDelay: 1000ms
       - Default maxDelay: 30000ms
       - Formula: min(baseDelay * 2^attemptNumber, maxDelay) + jitter
       - Jitter: random 0-1000ms to prevent thundering herd

    2. retry<T>(fn: () => Promise<T>, options?: RetryOptions): Promise<T>
       - options.maxAttempts: default 3
       - options.onRetry?: (attempt: number, delay: number) => void
       - Calls fn, catches errors, waits backoff time, retries
       - After maxAttempts, throws last error

    Pattern from RESEARCH.md for backoff:
    ```typescript
    function calculateBackoff(attemptNumber: number): number {
      const baseDelay = 1000
      const maxDelay = 30000
      const exponentialDelay = Math.min(
        baseDelay * Math.pow(2, attemptNumber),
        maxDelay
      )
      const jitter = Math.random() * 1000
      return exponentialDelay + jitter
    }
    ```
  </action>
  <verify>TypeScript compiles: cd frontend && npx tsc --noEmit</verify>
  <done>retry.ts exports calculateBackoff and retry functions with proper types</done>
</task>

</tasks>

<verification>
1. cd frontend && npm ls sonner react-loading-skeleton react-swipeable react-simple-pull-to-refresh react-error-boundary
2. cd frontend && npx tsc --noEmit (no type errors)
3. Verify exports exist: grep -l "export.*useBreakpoint" frontend/src/hooks/useBreakpoint.ts
4. Verify exports exist: grep -l "export.*calculateBackoff" frontend/src/lib/retry.ts
</verification>

<success_criteria>
- All 5 npm packages installed
- useBreakpoint hook detects mobile/tablet/desktop breakpoints
- retry utility provides exponential backoff with jitter
- TypeScript compiles without errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-ui-polish-production-readiness/04-01-SUMMARY.md`
</output>
